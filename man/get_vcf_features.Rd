% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/step2.create_results.R
\name{get_vcf_features}
\alias{get_vcf_features}
\title{Extract and Annotate Variant Features from VCF File}
\usage{
get_vcf_features(vcffile, sample_wt, sample_mut)
}
\arguments{
\item{vcffile}{Path to the input VCF file (compressed or uncompressed).}

\item{sample_wt}{Name of the wild-type sample as it appears in the VCF header.}

\item{sample_mut}{Name of the mutant sample as it appears in the VCF header.}
}
\value{
A data frame containing annotated variant features with the following columns:
\itemize{
\item \strong{Basic Variant Info:} CHROM, POS, ID (chromosome_position), REF, ALT, FILTER
\item \strong{Functional Annotation:} mutation_effect, mutation_effect_level, CDS_change, protein_change, Gene
\item \strong{Genotype Calls:} GT_WT, GT_MUT (genotype strings)
\item \strong{Depth Metrics:} AD_WT, AD_MUT (allelic depths), DP_WT, DP_MUT (total depths)
\item \strong{Quality Metrics:} PL_WT, PL_MUT (phred-scaled likelihoods)
\item \strong{Frequency Metrics:} AF_WT, AF_MUT (allele frequencies), detaAF (AF_MUT - AF_WT)
\item \strong{Variant Characteristics:} RTA (reference>alternate), EMS_is (1 if EMS-type mutation), Pr_change_is (1 if protein-changing)
\item \strong{Statistical Metrics:} ED4 (Euclidean distance^4 of allele frequencies)
\item \strong{Regional Density:} SNP_count_2Mb (variants in Â±1Mb window)
}
}
\description{
Processes a VCF file to extract genomic variants, compute allele frequencies,
add functional annotations, and calculate quality metrics for mutation analysis.
Designed for paired wild-type (WT) and mutant (MUT) samples.
}
\details{
Key processing steps include:
\enumerate{
\item Parse VCF using \code{vcfR} and extract fixed fields + genotype matrices (GT/AD/PL)
\item Split INFO field to extract functional annotations (VEP/Snpeff-style)
\item Calculate allele frequencies and depths from AD fields
\item Filter multi-allelic variants and missing/invalid genotypes
\item Compute variant-specific features:
\itemize{
\item EMS mutation flag (G>A or C>T transitions)
\item Protein change impact (excluding synonymous)
\item Allelic divergence metric (ED4)
}
\item Annotate regional variant density using parallel computation
}
}
\note{
\itemize{
\item Requires exactly 2 samples in VCF (WT and MUT)
\item INFO field must contain pipe-delimited annotations (standard in VEP/Snpeff)
\item Uses 8-core parallelization for regional density calculation (modify with \code{registerDoParallel})
\item Multi-allelic sites are automatically excluded
}
}
\section{Warning}{

Parallel computation uses \code{foreach} and \code{doParallel}. Ensure sufficient memory for large VCFs.
}

\examples{
\dontrun{
# Example usage:
vcf_path <- system.file("extdata", "sample.vcf.gz", package = "vcfR")
features <- get_vcf_features(
  vcffile = vcf_path,
  sample_wt = "P1_WT",
  sample_mut = "P1_MUT"
)
head(features)
}

}
